%% \newcommand{\mfrac}[2]{\frac{#1}{#2}}

\chapter{导数理论}

\section{导数的定义}

\begin{definition}
    设函数 $y=f(x)$ 在点 $x_0$ 的某邻域有定义，若极限
    $$\lim_{x\to x_0}\frac{f(x)-f(x_0)}{x-x_0}$$
    存在，则称函数 $f$ 在点 $x_0$ 可导，并称该极限为函数 $f$ 在点 $x_0$ 的导数，记作 $f'(x_0)$。
\end{definition}

\begin{theorem}
    若函数 $f$ 在点 $x_0$ 可导，则 $f$ 在点 $x_0$ 连续。
\end{theorem}

\begin{definition}
    设函数 $y=f(x)$ 在点 $x_0$ 的某右邻域 $[x_0,x_0+\delta)$ 上有定义，若右极限
    $$\lim_{\Delta x\to 0^+}\frac{\Delta y}{\Delta x} = \lim_{\Delta x\to 0^+}\frac{f(x_0+\Delta x)-f(x_0)}{\Delta x},(0<\Delta x<\delta)$$
    存在，则称该极限值为 $f$ 在点 $x_0$ 的右导数，记作 $f_+'(x)$。同理有左导数。
\end{definition}

左导数和右导数统称为单侧导数。

\begin{theorem}
    若函数 $y=f(x)$ 在点 $x_0$ 的某邻域上有定义，则 $f'(x_0)$ 存在的充要条件是 $f_-'(x)$ 与 $f_+'(x)$ 都存在且相等。
\end{theorem}

若函数 $f$ 在区间 $I$ 上每一点都可导（对区间端点，仅考虑相应的单侧导数），则称 $f$ 为 $I$ 上的可导函数。此时对每一个 $x\in I$，都有 $f$ 的一个导数 $f'(x)$ （或单侧导数）与之对应。

这样就定义了一个在 $I$ 上的函数，称为导函数，简称为导数。记作 $f',y',\dfrac{\d y}{\d x}$，即

$$f'(x) = \lim_{\Delta x \to 0}\frac{f(x+\Delta)-f(x)}{\Delta},x\in I$$

有时 $f'(x_0)$ 也可写作 $y'\mid_{x=x_0}$ 或 $\mfrac{\d y}{\d x}\mid_{x=x_0}$。

曲线 $y = f(x)$ 在点 $(x_0,y_0)$ 的切线方程是
$$y-y_0 = f'(x_0)(x-x_0)$$

\begin{definition}
    若函数 $f$ 在点 $x_0$ 的某邻域 $U(x_0)$ 上对一切 $x\in U(x_0)$ 有
    $$f(x_0) \geqslant f(x)$$
    则称 $f$ 在点 $x_0$ 取得极大值，称点 $x_0$ 为极大值点。同理有极小值点。
\end{definition}

极大值、极小值统称为极值，极大值点、极小值点统称为极值点。

\begin{theorem}[费马定理]
    设函数 $f$ 在点 $x_0$ 的某邻域上有定义，且在点 $x_0$ 可导。若点 $x_0$ 为极值点，则必有 $f'(x_0)=0$。
\end{theorem}

\section{求导法则}

\begin{theorem}
    若函数 $u(x)$ 和 $v(x)$ 在点 $x_0$ 可导，则函数 $f(x)=u(x)\pm v(x)$ 在点 $x_0$ 也可导，且
    $$f'(x_0) = u'(x_0)\pm v'(x_0)$$
    函数 $f(x)=u(x)v(x)$ 在点 $x_0$ 也可导，且
    $$f'(x_0) = u'(x_0)v'(x_0)$$
    若 $v(x)\ne 0$，则函数 $f(x)=\dfrac{u(x)}{v(x)}$ 在点 $x_0$ 也可导，且
    $$f'(x_0) = \frac{u'(x_0)v(x_0)-u(x_0)v'(x_0)}{v(x_0)^2}$$
\end{theorem}

\begin{theorem}
    设 $y=f(x)$ 为 $x=\phi(x)$ 的反函数，若 $\phi(y)$ 在点 $y_0$ 的某邻域上连续、严格单调且 $\phi'(y_0)\ne0$，则 $f(x)$ 在点 $x_0=\phi(y_0)$ 可导，且
    $$f'(x_0)=\frac{1}{\phi'(y_0)}$$
\end{theorem}

\begin{theorem}
    设 $u=\phi(x)$ 在点 $x_0$ 可导，$y=f(u)$ 在点 $u_0=\phi(x_0)$ 可导，则复合函数 $f\circ \phi$ 在点 $x_0$ 可导，且
    $$(f\circ \phi)'(x_0) = f'(u_0)\phi'(x_0) = f'(\phi(x_0))\phi'(x_0)$$
\end{theorem}

\subsection{基本求导法则}

1. $(u\pm v)' = u'\pm v'$

2. $(uv)' = u'v+uv'$

3. $\left(\dfrac{u}{v}\right) = \dfrac{u'v-uv'}{v^2}$

4. $(u\pm v)' = u'\pm v'$

\subsection{基本初等函数导数公式}

1. $(c)' = 0$（$c$ 为常数）

2. $(x^a)' = ax^{a-1}$（$a$ 为任意实数）

3. $(\sin x)' = \cos x,(\cos x)'=-\sin x,(\tan x)'=\sec^2x$

4. $(\cot x)' = -\csc^2 x,(\sec x)'=\sec x \tan x,(\csc x)'=-\csc x \cot x$

5. $(\arcsin x)'=\dfrac{1}{\sqrt{1-x^2}},(\arccos x)' = -\dfrac{1}{\sqrt{1-x^2}},(\arctan x)'=\dfrac{1}{1+x^2}$

6. $(a^x)'=a^x \ln a(a>0\text{且}a\ne 1)$

7. $(\log_a|x|)'=\dfrac{1}{x\ln a}(a>0\text{且}a\ne 1)$

\section{单调性与导数}

\begin{theorem}
    设 $f$ 在区间 $I$ 上可导，则 $f(x)$ 在 $I$ 上递增（减） 的充要条件时
    $$f'(x) \geqslant 0(\leqslant 0)$$
\end{theorem}

\begin{theorem}[介值定理]
    设 $f$ 为 $[a,b]$ 上的连续函数，$\mu$ 时严格介于 $f(a)$ 和 $f(b)$ 之间的数，则存在 $\xi\in (a,b)$，使得 $f(\xi)=\mu$。
\end{theorem}

\section{曲率}

给定光滑曲线 $C$，取固定点 $M$ 和动点 $N$ 得到弧长 $\Delta s$。$N$ 处与 $M$ 处的切线和 $x$ 正轴夹角差记为 $\Delta \alpha$。以此定义 $M$ 处的曲率为
\[ k = \lim_{\Delta s \to 0} \left| \frac{\Delta \alpha}{\Delta s} \right| \]

假设光滑曲线由参数方程 $x(t), y(t)$ 给出，那么可以得到
\[ \alpha = \arctan \frac{y'(t)}{x'(t)}, \quad \frac{\d \alpha}{\d t} = \frac{y''(t)x'(t) - y'(t) x''(t)}{x'(t)^2 + y'(t)^2} \]
利用 $\d s/ \d t = \sqrt{x'(t)^2 + y'(t)^2}$ 得到
\[ k = \left| \frac{\d a / \d t}{\d s \d t} \right| = \frac{|y''(t)x'(t) - y'(t) x''(t)|}{(x'(t)^2 + y'(t)^2)^{3/2}} \]
特别的曲线如果由 $y(x)$ 给出，那么
\[ k = \frac{|y''|}{(1+y'^2)^{3/2}} \]
其中令 $R = 1/k$ 为曲线的曲率半径。

\section{中值定理}

\section{拉格朗日 Lagrange 定理}

\begin{theorem}[罗尔 Rolle 中值定理]
    若函数 $f$ 在 $[a,b]$ 上连续，在 $(a,b)$ 中可微，且 $f(a)=f(b)$。则存在 $\xi\in(a,b)$，使得 $f'(\xi)=0$。
\end{theorem}

\begin{proof}
    因为 $f(x)$ 在 $[a,b]$ 上连续，所以有最大值 $M$ 和最小值 $m$。

    1. 若 $m=M$，显然成立。

    2. 若 $m < M$，又 $f(a) = f(b)$，故最值必然在 $\xi \in (a, b)$ 中取到，从而 $x=\xi$ 是其极值点，由费马定理知 $f'(\xi) = 0$。
\end{proof}

\begin{theorem}
    若函数 $f$ 在 $[a,b]$ 上连续，在 $(a,b)$ 中可微，则存在 $\xi\in(a,b)$，使得
    $$f'(\xi)=\frac{f(b)-f(a)}{b-a}$$
\end{theorem}



\begin{proof}
    做辅助函数
    \[ F(x) = f(x) - f(a) - \frac{f(b) - f(a)}{b - a}(x - a) \]
    显然 $F(a) = F(b) = 0$，且满足 Rolle 定理的其他两个条件，故存在 $\xi \in (a, b)$ 使得
    \[ F'(\xi) = f'(\xi) - \frac{f(b) - f(a)}{b - a} = 0 \]
    移项即证。
\end{proof}

Lagrange 公式还有下面几种等价形式

$$f(b)-f(a) = f'(\xi)(b-a),a<\xi<b$$
$$f(b)-f(a) = f'(a+\theta(b-a))(b-a),0<\theta<1$$
$$f(a+h) - f(a) = f'(a+\theta h)h,0<\theta<1$$

\subsection{Cauchy 中值定理}

\begin{theorem}
    设 $f,g$ 在 $[a,b]$ 上连续，在 $(a,b)$ 中可微，且 $g'(x)\ne 0$，则存在 $\xi\in (a,b)$，使得
    $$\frac{f(b)-f(a)}{g(b)-g(a)} = \frac{f'(\xi)}{g'(\xi)}$$
\end{theorem}

\subsection{凹凸性}

\begin{definition}
    设 $f$ 为定义在区间 $I$ 上的函数，若对 $I$ 上当任意两点 $x_1,x_2$ 和任意实数 $\lambda\in (0,1)$ 总有
    $$f(\lambda x_1+(1-\lambda)x_2) \leqslant \lambda f(x_1)+(1-\lambda)f(x_2)$$
    则称 $f$ 为 $I$ 上的凸函数。反之，如果总有
    $$f(\lambda x_1+(1-\lambda)x_2) \geqslant \lambda f(x_1)+(1-\lambda)f(x_2)$$
    则称 $f$ 为 $I$ 上的凹函数。
\end{definition}

