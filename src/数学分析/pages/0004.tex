\chapter{导数理论}

\section{导数的定义}

\begin{definition}[微分]
	设函数 $f$ 定义在某个邻域内 $U(x_0, r)$ 内，如果存在常数 $A$ 使得
	\[ f(x) = f(x_0) + A(x - x_0) + o(x - x_0) \]
	当 $x \to x_0$ 成立，则称 $f$ 在 $x_0$ 处可微。线性函数 $A(x-x_0)$ 称为 $f$ 在 $x_0$ 处的微分。
\end{definition}

我们记作 $\d y = \d f = A \d x$。

\begin{definition}[导数]
	设函数 $y=f(x)$ 在邻域 $U(x_0, r)$ 内有定义，若极限
	\[ \lim_{x\to x_0}\frac{f(x)-f(x_0)}{x-x_0} \]
	存在，则称函数 $f$ 在点 $x_0$ 可导，并称该极限为函数 $f$ 在点 $x_0$ 的导数，记作 $f'(x_0)$。
\end{definition}

\begin{theorem}
	若函数 $f$ 在点 $x_0$ 可导，则 $f$ 在点 $x_0$ 连续，反之不然。
\end{theorem}

显然一元函数的可微概念等价于可导。

\begin{example}
	考察
	\[ f_n(x) = x^n \sin \frac{1}{x}, \quad f_n(0) = 0 \]
	当 $n \geqslant 1$ 时，有
	\[ \lim_{x \to 0} f_n(x) = \lim_{x \to 0} \left( x \sin \frac{1}{x} \right) x^{n-1} = 0  \]
	当 $n \geqslant 2$ 时，有
	\[ f_n'(0) = \lim_{\Delta x \to 0} \frac{f(0 + \Delta x) - f(0)}{\Delta x} = \lim_{\Delta x \to 0} f_{n-1}(\Delta x) = 0 \]
	当 $n \geqslant 3$ 时，有
	\[ f'(x) = x^{n-2}\left(n x\sin \frac{1}{x} - \cos \frac{1}{x}\right) \]
	从而 $\lim\limits_{x \to 0} f'(x) = 0$。

	因此，$f_1(x)$ 在 $\mathbb{R}$ 上连续，但在 $x=0$ 处不可导。$f_2(x)$ 连续且 $f_2'(0)$ 存在，但 $x=0$ 处导函数不连续。$f_3(x)$ 连续且导函数连续。
\end{example}

\begin{definition}[单侧导数]
	设函数 $y=f(x)$ 在点 $x_0$ 的某右邻域 $[x_0,x_0+\delta)$ 上有定义，若右极限
	\[ \lim_{\Delta x\to 0^+}\frac{\Delta y}{\Delta x} = \lim_{\Delta x\to 0^+}\frac{f(x_0+\Delta x)-f(x_0)}{\Delta x},(0<\Delta x<\delta) \]
	存在，则称该极限值为 $f$ 在点 $x_0$ 的右导数，记作 $f_+'(x)$。同理有左导数。左导数和右导数统称为单侧导数。
\end{definition}



\begin{theorem}
	若函数 $y=f(x)$ 在点 $x_0$ 的某邻域上有定义，则 $f'(x_0)$ 存在的充要条件是 $f_-'(x)$ 与 $f_+'(x)$ 都存在且相等。
\end{theorem}

若函数 $f$ 在区间 $I$ 上每一点都可导（对区间端点，仅考虑相应的单侧导数），则称 $f$ 为 $I$ 上的可导函数。此时对每一个 $x\in I$，都有 $f$ 的一个导数 $f'(x)$ （或单侧导数）与之对应。这样就定义了一个在 $I$ 上的函数，称为导函数，简称为导数。记作 $f',y',\dfrac{\d y}{\d x}$。

曲线 $y = f(x)$ 在点 $(x_0,y_0)$ 的切线方程是
\[ y-y_0 = f'(x_0)(x-x_0) \]

这个极限还可以进行一定的变化，比如当 $f$ 在 $x_0$ 处可导时有
\[ \lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x) - f(x_0 - \Delta x)}{2 \Delta x} = f'(x_0) \]
反之不成立，比如 $y = |x|$。

有一些可能不太好想的反例：
\[ \lim_{x \to a+} f(x) = \infty \not\Rightarrow \lim_{x \to a+} f'(x) = \infty \]
取
\[ f(x) = \frac{1}{x} + \cos \frac{1}{x}, \quad 0 < x < \frac{\pi}{2} \]
如
\[ \lim_{x \to a+} f'(x) = \infty \not\Rightarrow \lim_{x \to a+} f(x) = \infty \]
取
\[ f(x) = \sqrt[3]{x}, \quad 0 < x < 1 \]
如
\[ \lim_{x \to +\infty} f(x) = A \not\Rightarrow \lim_{x \to +\infty} f'(x) = B \]
取
\[ f(x) = \frac{\sin(x^2)}{x} \]
如
\[ \lim_{x \to +\infty} f'(x) = A \not\Rightarrow \lim_{x \to +\infty} f(x) = B \]
取
\[ f(x) = \cos(\ln x) \]
这说明端点处取无穷大和函数导数在端点处取无穷大没有本质联系。

\subsection{高阶导数}

进一步的，我们可以定义导数的导数。
\[ f^{(n_1)}(x_0) = \left(f^{(n)}\right)' (x_0) = \frac{\d^k f}{\d x^k}(x_0) \]
任意阶导数都存在的函数称为光滑的。

二阶微分不具有微分不变性，比如 $y = f(u), u = g(x)$，有
\[ \frac{\d^2 y}{\d x^2} = \frac{\d^2 y}{\d u^2} \left(\frac{\d u}{d x}\right)^2 + \frac{\d y}{\d u} \frac{\d^2 u}{\d x^2} \]

\begin{theorem}
	假如 $f(x)$ 在 $a$ 处二阶可导，则
	\[ f''(a) = \lim_{h \to 0} \frac{f(a + h) + f(a - h) - 2f(a)}{h^2} \]
\end{theorem}

\begin{proof}
	注意，这里转化为一阶导数定义再导出二阶的方法是错误的。只能使用 L'Hospital 法则。
\end{proof}

\section{求导法则}

\begin{theorem}
	若函数 $u(x)$ 和 $v(x)$ 在点 $x_0$ 可导，则函数 $f(x)=u(x)\pm v(x)$ 在点 $x_0$ 也可导，且
	\[ f'(x_0) = u'(x_0)\pm v'(x_0) \]
	函数 $f(x)=u(x)v(x)$ 在点 $x_0$ 也可导，且
	\[ f'(x_0) = u'(x_0)v'(x_0) \]
	若 $v(x)\ne 0$，则函数 $f(x)=\frac{u(x)}{v(x)}$ 在点 $x_0$ 也可导，且
	\[ f'(x_0) = \frac{u'(x_0)v(x_0)-u(x_0)v'(x_0)}{v(x_0)^2} \]
	特别的，当 $f(x) = \frac{1}{v(x)}$ 时，有
	\[ f'(x_0) = -\frac{v'(x_0)}{v(x_0)^2} \]
\end{theorem}

\begin{theorem}
	设 $y=f(x)$ 严格单调且 $f'(x_0) \neq 0$，则其反函数 $x = f^{-1}(x) = g(y)$ 在对应区间内可导且且
	\[ g'(y_0)=\frac{1}{f'(x_0)} \]
\end{theorem}

\begin{theorem}
	设 $u=\phi(x)$ 在点 $x_0$ 可导，$y=f(u)$ 在点 $u_0=\phi(x_0)$ 可导，则复合函数 $f\circ \phi$ 在点 $x_0$ 可导，且
	\[ (f\circ \phi)'(x_0) = f'(u_0)\phi'(x_0) = f'(\phi(x_0))\phi'(x_0) \]
\end{theorem}

\subsection{基本求导法则}

1. $(u\pm v)' = u'\pm v'$

2. $(uv)' = u'v+uv'$

3. $\left(\dfrac{u}{v}\right) = \dfrac{u'v-uv'}{v^2}$

4. $(u\pm v)' = u'\pm v'$

\subsection{基本初等函数导数公式}

1. $(c)' = 0$（$c$ 为常数）

2. $(x^a)' = ax^{a-1}$（$a$ 为任意实数）

3. $(\sin x)' = \cos x,(\cos x)'=-\sin x,(\tan x)'=\sec^2x$

4. $(\cot x)' = -\csc^2 x,(\sec x)'=\sec x \tan x,(\csc x)'=-\csc x \cot x$

5. $(\arcsin x)'=\dfrac{1}{\sqrt{1-x^2}},(\arccos x)' = -\dfrac{1}{\sqrt{1-x^2}},(\arctan x)'=\dfrac{1}{1+x^2}$

6. $(a^x)'=a^x \ln a(a>0\text{且}a\ne 1)$

7. $(\log_a|x|)'=\dfrac{1}{x\ln a}(a>0\text{且}a\ne 1)$

\section{极值定理}

若函数 $f$ 在点 $x_0$ 的某邻域 $U(x_0)$ 上对一切 $x\in U(x_0)$ 有
\[ f(x_0) \geqslant f(x) \]
则称 $f$ 在点 $x_0$ 取得极大值，称点 $x_0$ 为极大值点。同理有极小值点。极大值、极小值统称为极值，极大值点、极小值点统称为极值点。

显然极值点不一定是最值点，但假如最值点在定义域内部，则必是极值点。

\begin{theorem}[Fermat 定理]
	设函数 $f$ 在点 $x_0$ 的某邻域上有定义，且在点 $x_0$ 可导。若点 $x_0$ 为极值点，则必有 $f'(x_0)=0$。
\end{theorem}

\begin{proof}
	不妨设 $x_0$ 为 $f$ 的极小值点，则存在邻域 $U(x_0, \delta)$ 且满足不等式 $f(x) \leqslant f(x_0)$，那么
	\[ \frac{f(x) - f(x_0)}{x - x_0} \geqslant 0, \quad x \in (x_0 - \delta, x_0) \qquad
		\frac{f(x) - f(x_0)}{x - x_0} \leqslant 0, \quad x \in (x_0, x_0 + \delta) \]
	从而
	\[ 0 \leqslant f_+'(x_0) = f'(x_0) = f_-'(x_0) \leqslant 0 \]
	故 $f'(x_0) = 0$。
\end{proof}

如果 $f'(x_0) = 0$，我们称为驻点。极值点不一定是驻点，比如 $y = |x|$，需要导数存在，反之驻点不一定是极值点，如 $y = x^3$。

\begin{theorem}[Darboux 定理]
	稼穑和 $f$ 在 $(a, b)$ 上存在导数，且存在相异的两点使得 $f'(x_1)f'(x_2) < 0$，则存在 $\xi \in (x_1, x_2)$ 使得 $f'(\xi) = 0$。
\end{theorem}

\begin{proof}
	注意该定理并未要求导数连续，无法使用介值定理。不妨设 $f'(x_1) < 0$ 且 $f'(x_2) > 0$，取 $f(\xi) = \min_{[x_1, x_2]} f$。取两个邻域
	\[ \frac{f(x) - f(x_1)}{x - x_1} < 0, \quad x \in U(x_1, \delta) \qquad
		\frac{f(x) - f(x_2)}{x - x_2} \leqslant 0, \quad x \in U(x_2, \delta) \]
	因此存在 $x_1 < x_3 < x_4 < x_2$ 使得 $f(x_3) < f(x_1)$ 和 $f(x_4) < f(x_2)$。故 $\xi$ 在开区间 $(x_1, x_2)$ 内，因此 $\xi$ 为 $f$ 的极值点，由 Fermat 定理知 $f'(\xi) = 0$。
\end{proof}

\section{曲率}

给定光滑曲线 $C$，取固定点 $M$ 和动点 $N$ 得到弧长 $\Delta s$。$N$ 处与 $M$ 处的切线和 $x$ 正轴夹角差记为 $\Delta \alpha$。以此定义 $M$ 处的曲率为
\[ k = \lim_{\Delta s \to 0} \left| \frac{\Delta \alpha}{\Delta s} \right| \]

假设光滑曲线由参数方程 $x(t), y(t)$ 给出，那么可以得到
\[ \alpha = \arctan \frac{y'(t)}{x'(t)}, \quad \frac{\d \alpha}{\d t} = \frac{y''(t)x'(t) - y'(t) x''(t)}{x'(t)^2 + y'(t)^2} \]
利用 $\d s/ \d t = \sqrt{x'(t)^2 + y'(t)^2}$ 得到
\[ k = \left| \frac{\d a / \d t}{\d s \d t} \right| = \frac{|y''(t)x'(t) - y'(t) x''(t)|}{(x'(t)^2 + y'(t)^2)^{3/2}} \]
特别的曲线如果由 $y(x)$ 给出，那么
\[ k = \frac{|y''|}{(1+y'^2)^{3/2}} \]
其中令 $R = 1/k$ 为曲线的曲率半径。

\section{中值定理}

微分中值定理主要有三个：Rolle 定理、Lagrange 中值定理和 Cauchy 中值定理。

\subsection{Rolle 定理}

\begin{theorem}[罗尔 Rolle 中值定理]
	若函数 $f$ 在 $[a,b]$ 上连续可导，且 $f(a)=f(b)$。则存在 $\xi\in(a,b)$，使得 $f'(\xi)=0$。
\end{theorem}

\begin{proof}
	因为 $f(x)$ 在 $[a,b]$ 上连续，所以有最大值 $M$ 和最小值 $m$。

	1. 若 $m=M$，显然成立。

	2. 若 $m < M$，又 $f(a) = f(b)$，故最值必然在 $\xi \in (a, b)$ 中取到，从而 $x=\xi$ 是其极值点，由 Fermat 定理知 $f'(\xi) = 0$。
\end{proof}

我们可以做更多点的推广。假如 $f(x_1) = f(x_2) = f(x_3)$ 都相等，据此存在 $\xi_1 \in (x_1, x_2)$ 和 $\xi_2 \in (x_2, x_3)$ 使得 $f'(\xi_1) = f'(\xi_2) = 0$，再用一遍定理知存在 $\xi_3 \in (\xi_1, \xi_2)$ 使得 $f''(\xi_3) = 0$。

\begin{example}
	设 $f$ 在 $[a,b]$ 上连续并二阶可导，且 $f(a) = f(b) = 0$，那么对任意的 $x \in (a, b)$ 存在 $\xi_x \in (a,b)$ 满足
	\[ f(x) = \frac{f''(\xi_x)}{2}(x-a)(x-b) \]
\end{example}

\begin{proof}
	对于任意的 $x$，我们定义常数
	\[ \lambda_x = \frac{2 f(x)}{(x - a)(x - b)} \]
	构造函数
	\[ F(u) = f(u) - \frac{\lambda_x}{2} (u-a)(u-b) \]
	注意到 $F(a) = F(x) = F(b)$，且 $F''(u) = f''(u) - \lambda_x$，由上文所证性质，故存在 $\xi_x \in (a, b)$ 使得 $f''(\xi_x) = \lambda_x$。
\end{proof}

\begin{example}
	设函数 $f$ 在 $[a,b]$ 上连续并三阶可导，如果 $f(a) = f'(a) = f(b) = 0$，那么对任意的 $x$ 存在 $\xi_x \in (a, b)$ 使得
	\[ f(x) = \frac{f'''(\xi_x)}{3!} (x-a)^2(x-b) \]
\end{example}

\begin{proof}
	构造
	\[ F(u) = f(u) - \frac{\lambda_x}{3!}(u-a)^2(u-b), \quad \lambda_x = \frac{3! f(x)}{(x-a)^2(x-b)} \]
	余略。
\end{proof}


\subsection{Lagrange 定理}

Rolle 定理需要两个函数等高，假如不等高我们可以旋转一下。

\begin{theorem}[Lagrange 定理]
	若函数 $f$ 在 $[a,b]$ 上连续，在 $(a,b)$ 中可微，则存在 $\xi\in(a,b)$，使得
	\[ f'(\xi)=\frac{f(b)-f(a)}{b-a} \]
\end{theorem}

\begin{proof}
	做辅助函数
	\[ F(x) = f(x) - f(a) - \frac{f(b) - f(a)}{b - a}(x - a) \]
	显然 $F(a) = F(b) = 0$，且满足 Rolle 定理的其他两个条件，故存在 $\xi \in (a, b)$ 使得
	\[ F'(\xi) = f'(\xi) - \frac{f(b) - f(a)}{b - a} = 0 \]
	移项即证。
\end{proof}

一般可以直接说，存在 $\xi \in (a, b)$ 使得 $f(b) - f(a) = f'(\xi)(b-a)$。考虑设
\[ \xi = (1-\theta)a + \theta b = a + \theta(b-a), \quad \theta \in (0, 1) \]
因此可以说存在 $\theta \in (0, 1)$ 使得
\[ f(b) - f(a) = f'(a + \theta(b-a)) (b-a) \]

\subsection{Cauchy 中值定理}

\begin{theorem}
	设 $f,g$ 在 $[a,b]$ 上连续，在 $(a,b)$ 中可微，且 $g'(x)\ne 0$，则存在 $\xi\in (a,b)$，使得
	\[ \frac{f(b)-f(a)}{g(b)-g(a)} = \frac{f'(\xi)}{g'(\xi)} \]
\end{theorem}

\begin{proof}
	首先注意到 $g(b) \neq g(a)$，否则由 Rolle 定理知存在 $g'(x) = 0$。构造
	\[ F(x) = f(x) - f(a) - \lambda (g(x) - g(a)) , \quad \lambda = \frac{f(b) - f(a)}{g(b) - g(a)} \]
	注意到 $F(a) = F(b) = 0$，由 Rolle 定理知存在 $\xi \in (a, b)$
	\[ F'(\xi) = f'(\xi) - \lambda g'(\xi) = 0 \]
\end{proof}

Cauchy 中值定理就更加的变化多端了。

\subsection{凹凸性}

\begin{definition}
	设 $f$ 为定义在区间 $I$ 上的函数，若对 $I$ 上当任意两点 $x_1,x_2$ 和任意实数 $\lambda\in (0,1)$ 总有
	\[ f(\lambda x_1+(1-\lambda)x_2) \leqslant \lambda f(x_1)+(1-\lambda)f(x_2) \]
	则称 $f$ 为 $I$ 上的凸函数。反之，如果总有
	\[ f(\lambda x_1+(1-\lambda)x_2) \geqslant \lambda f(x_1)+(1-\lambda)f(x_2) \]
	则称 $f$ 为 $I$ 上的凹函数。
\end{definition}

\section{L'Hospital 法则}

\begin{theorem}[L'Hospital 法则，0/0 型]
	设 $f,g$ 是 $(a,b)$ 上的连续可导函数，$g' \neq 0$，且
	\[ \lim_{x \to a^{+}} f(x) = \lim_{x \to a^{+}} g(x) = 0 \]
	如果极限
	\[ \lim_{x \to a^{+}} \frac{f'(x)}{g'(x)} = A \]
	其中 $A$ 为实数或 $\infty$。则
	\[ \lim_{x \to a^{+}} \frac{f(x)}{g(x)} = \lim_{x \to a^{+}} \frac{f'(x)}{g'(x)} \]
\end{theorem}

\begin{proof}
	考虑补上 $x=a$ 处的零值，延展函数 $f, g$ 为 $F, G$，从而存在 $\xi_x \in (a, x)$ 使得
	\[ \frac{F(x)}{G(x)} = \frac{F(x) - F(a)}{G(x) - G(a)} = \frac{F'(\xi_x)}{G'(\xi_x)} \]
	因此当 $x \to a^+$ 时，$\xi_x \to a^+$。故
	\[ \lim_{x \to a^{+}} \frac{f(x)}{g(x)} = \lim_{\xi_x \to a^{+}} \frac{f'(\xi_x)}{g'(\xi_x)} \]
\end{proof}

\begin{theorem}[L'Hospital 法则，0/0 型]
	设 $f,g$ 是 $(a,b)$ 上的连续可导函数，$g' \neq 0$，且
	\[ \lim_{x \to a^{+}} f(x) = \lim_{x \to a^{+}} g(x) = \infty \]
	如果极限
	\[ \lim_{x \to a^{+}} \frac{f'(x)}{g'(x)} = A \]
	其中 $A$ 为实数或 $\infty$。则
	\[ \lim_{x \to a^{+}} \frac{f(x)}{g(x)} = \lim_{x \to a^{+}} \frac{f'(x)}{g'(x)} \]
\end{theorem}

对于 $0 \cdot \infty$，一般考虑
\[ \lim_{x \to a} f(x) g(x) = \lim_{x \to a} \frac{f(x)}{\frac{1}{g(x)}} \]
对于 $\infty - \infty$，一般考虑
\[ \lim_{x \to a} (f(x) - g(x)) = \lim_{x \to a} \frac{\frac{1}{f(x)} - \frac{1}{g(x)}}{\frac{1}{f(x)g(x)}} \]
倘若 $0^0$、$\infty^0$、$1^\infty$，则
\[ \lim_{x \to a} f(x)^{g(x)} = \exp \left(\lim_{x \to a} g(x) \ln f(x) \right) \]

\section{Taylor 公式}

假设函数 $f$ 在 $x_0$ 处 $n$ 阶可导，定义其在 $x_0$ 处的 $n$ 阶 Taylor 多项式定义为
\[ P_n(x;x_0, f) = f(x_0) + \sum_{k=1}^{n} \frac{f^{(k)}(x_0)}{k!} (x-x_0)^k \]
当 $x_0 = 0$ 时，即为 Maclaurin 公式。

\subsection{Peano 型余项}
存在 $\delta > 0$ 使得对 $x \in (x_0 - \delta, x_0 + \delta)$ 有
\[ f(x) = P_n(x) + r_n(x) \]
这里
\[ r_n(x) = o((x-x_n)^n), \quad x \to x_0 \]
我们可以通过洛 $n$ 次证明。

\subsection{Lagrange 型余项}
由 Lagrange 中值定理，考虑在 $(x_0, x_0 + \delta)$，对任意的 $x$ 都存在 $\xi_1$ 使得
\[ f(x) = f(x_0) + f'(\xi_1)(x-x_0) \]
大胆的推广一下，我们可以证明
\[ f(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{f''(\xi_2)}{2}(x-x_0)^2 \]
一般的，我们就得到了 Lagrange 型余项。

\begin{theorem}
	存在 $\delta > 0$，设 $f$ 在 $(x_0, x_0+\delta)$ 上连续并 $n + 1$ 阶可导，则对任意的 $x$ 都存在 $\xi$ 有
	\[ f(x) = P_n(x) + r_n(x) \]
	其中
	\[ r_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1} \]
\end{theorem}

\begin{proof}
	固定 $x$，构造辅助函数
	\[ G(t) = f(x) - \sum_{k=0}^n \frac{f^{(k)}(t)}{k!} (x-t)^k \]
	并任意的取在 $(x_0, x_0 + \delta)$ 上连续可导的函数 $H(t)$，且 $H(x) = 0$。存在 $\xi \in (x_0, x_0 + \delta)$ 满足
	\[ \frac{G(x_0)}{H(x_0)} = \frac{G(x) - G(x_0)}{H(x) - H(x_0)} = \frac{G'(\xi)}{H'(\xi)} = -\frac{f^{(n+1)}(\xi)}{n!H'(\xi)}(x-\xi)^n \]
	即
	\[ G(x_0) = -\frac{f^{(n+1)}(\xi)}{n! H'(\xi)}(x-\xi)^nH(x_0) \]
	取 $H(t) = (x-t)^{n+1}$ 即证。
\end{proof}

\subsection{Cauchy 型余项}

\begin{theorem}
	存在 $\delta > 0$，设 $f$ 在 $(x_0, x_0+\delta)$ 上连续并 $n + 1$ 阶可导，则对任意的 $x$ 都存在 $\xi$ 有
	\[ f(x) = P_n(x) + r_n(x) \]
	其中
	\[ r_n(x) = \frac{f^{(n+1)}(\xi)}{n!}(x-\xi)^n(x-x_0) \]
\end{theorem}

\begin{proof}
	在上一个证明中取 $H(t) = x - t$ 即可。
\end{proof}

