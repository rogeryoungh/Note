%% \newcommand{\mfrac}[2]{\frac{#1}{#2}}

\chapter{导数理论}

\section{导数的定义}

\begin{definition}
	设函数 $y=f(x)$ 在点 $x_0$ 的某邻域有定义，若极限
	\[ \lim_{x\to x_0}\frac{f(x)-f(x_0)}{x-x_0} \]
	存在，则称函数 $f$ 在点 $x_0$ 可导，并称该极限为函数 $f$ 在点 $x_0$ 的导数，记作 $f'(x_0)$。
\end{definition}

\begin{theorem}
	若函数 $f$ 在点 $x_0$ 可导，则 $f$ 在点 $x_0$ 连续。
\end{theorem}

\begin{definition}
	设函数 $y=f(x)$ 在点 $x_0$ 的某右邻域 $[x_0,x_0+\delta)$ 上有定义，若右极限
	\[ \lim_{\Delta x\to 0^+}\frac{\Delta y}{\Delta x} = \lim_{\Delta x\to 0^+}\frac{f(x_0+\Delta x)-f(x_0)}{\Delta x},(0<\Delta x<\delta) \]
	存在，则称该极限值为 $f$ 在点 $x_0$ 的右导数，记作 $f_+'(x)$。同理有左导数。
\end{definition}

左导数和右导数统称为单侧导数。

\begin{theorem}
	若函数 $y=f(x)$ 在点 $x_0$ 的某邻域上有定义，则 $f'(x_0)$ 存在的充要条件是 $f_-'(x)$ 与 $f_+'(x)$ 都存在且相等。
\end{theorem}

若函数 $f$ 在区间 $I$ 上每一点都可导（对区间端点，仅考虑相应的单侧导数），则称 $f$ 为 $I$ 上的可导函数。此时对每一个 $x\in I$，都有 $f$ 的一个导数 $f'(x)$ （或单侧导数）与之对应。

这样就定义了一个在 $I$ 上的函数，称为导函数，简称为导数。记作 $f',y',\dfrac{\d y}{\d x}$，即

$$f'(x) = \lim_{\Delta x \to 0}\frac{f(x+\Delta)-f(x)}{\Delta},x\in I$$

有时 $f'(x_0)$ 也可写作 $y'\mid_{x=x_0}$ 或 $\mfrac{\d y}{\d x}\mid_{x=x_0}$。

曲线 $y = f(x)$ 在点 $(x_0,y_0)$ 的切线方程是
$$y-y_0 = f'(x_0)(x-x_0)$$

\begin{definition}
	若函数 $f$ 在点 $x_0$ 的某邻域 $U(x_0)$ 上对一切 $x\in U(x_0)$ 有
	\[ f(x_0) \geqslant f(x) \]
	则称 $f$ 在点 $x_0$ 取得极大值，称点 $x_0$ 为极大值点。同理有极小值点。
\end{definition}

极大值、极小值统称为极值，极大值点、极小值点统称为极值点。

\begin{theorem}[Fermat 定理]
	设函数 $f$ 在点 $x_0$ 的某邻域上有定义，且在点 $x_0$ 可导。若点 $x_0$ 为极值点，则必有 $f'(x_0)=0$。
\end{theorem}

\begin{proof}
	不妨设 $x_0$ 为 $f$ 的极小值点，
\end{proof}

\section{求导法则}

\begin{theorem}
	若函数 $u(x)$ 和 $v(x)$ 在点 $x_0$ 可导，则函数 $f(x)=u(x)\pm v(x)$ 在点 $x_0$ 也可导，且
	\[ f'(x_0) = u'(x_0)\pm v'(x_0) \]
	函数 $f(x)=u(x)v(x)$ 在点 $x_0$ 也可导，且
	\[ f'(x_0) = u'(x_0)v'(x_0) \]
	若 $v(x)\ne 0$，则函数 $f(x)=\dfrac{u(x)}{v(x)}$ 在点 $x_0$ 也可导，且
	\[ f'(x_0) = \frac{u'(x_0)v(x_0)-u(x_0)v'(x_0)}{v(x_0)^2} \]
\end{theorem}

\begin{theorem}
	设 $y=f(x)$ 为 $x=\phi(x)$ 的反函数，若 $\phi(y)$ 在点 $y_0$ 的某邻域上连续、严格单调且 $\phi'(y_0)\ne0$，则 $f(x)$ 在点 $x_0=\phi(y_0)$ 可导，且
	\[ f'(x_0)=\frac{1}{\phi'(y_0)} \]
\end{theorem}

\begin{theorem}
	设 $u=\phi(x)$ 在点 $x_0$ 可导，$y=f(u)$ 在点 $u_0=\phi(x_0)$ 可导，则复合函数 $f\circ \phi$ 在点 $x_0$ 可导，且
	\[ (f\circ \phi)'(x_0) = f'(u_0)\phi'(x_0) = f'(\phi(x_0))\phi'(x_0) \]
\end{theorem}

\subsection{基本求导法则}

1. $(u\pm v)' = u'\pm v'$

2. $(uv)' = u'v+uv'$

3. $\left(\dfrac{u}{v}\right) = \dfrac{u'v-uv'}{v^2}$

4. $(u\pm v)' = u'\pm v'$

\subsection{基本初等函数导数公式}

1. $(c)' = 0$（$c$ 为常数）

2. $(x^a)' = ax^{a-1}$（$a$ 为任意实数）

3. $(\sin x)' = \cos x,(\cos x)'=-\sin x,(\tan x)'=\sec^2x$

4. $(\cot x)' = -\csc^2 x,(\sec x)'=\sec x \tan x,(\csc x)'=-\csc x \cot x$

5. $(\arcsin x)'=\dfrac{1}{\sqrt{1-x^2}},(\arccos x)' = -\dfrac{1}{\sqrt{1-x^2}},(\arctan x)'=\dfrac{1}{1+x^2}$

6. $(a^x)'=a^x \ln a(a>0\text{且}a\ne 1)$

7. $(\log_a|x|)'=\dfrac{1}{x\ln a}(a>0\text{且}a\ne 1)$

\section{单调性与导数}

\begin{theorem}
	设 $f$ 在区间 $I$ 上可导，则 $f(x)$ 在 $I$ 上递增（减） 的充要条件时
	\[ f'(x) \geqslant 0(\leqslant 0) \]
\end{theorem}

\begin{theorem}[介值定理]
	设 $f$ 为 $[a,b]$ 上的连续函数，$\mu$ 时严格介于 $f(a)$ 和 $f(b)$ 之间的数，则存在 $\xi\in (a,b)$，使得 $f(\xi)=\mu$。
\end{theorem}

\section{曲率}

给定光滑曲线 $C$，取固定点 $M$ 和动点 $N$ 得到弧长 $\Delta s$。$N$ 处与 $M$ 处的切线和 $x$ 正轴夹角差记为 $\Delta \alpha$。以此定义 $M$ 处的曲率为
\[ k = \lim_{\Delta s \to 0} \left| \frac{\Delta \alpha}{\Delta s} \right| \]

假设光滑曲线由参数方程 $x(t), y(t)$ 给出，那么可以得到
\[ \alpha = \arctan \frac{y'(t)}{x'(t)}, \quad \frac{\d \alpha}{\d t} = \frac{y''(t)x'(t) - y'(t) x''(t)}{x'(t)^2 + y'(t)^2} \]
利用 $\d s/ \d t = \sqrt{x'(t)^2 + y'(t)^2}$ 得到
\[ k = \left| \frac{\d a / \d t}{\d s \d t} \right| = \frac{|y''(t)x'(t) - y'(t) x''(t)|}{(x'(t)^2 + y'(t)^2)^{3/2}} \]
特别的曲线如果由 $y(x)$ 给出，那么
\[ k = \frac{|y''|}{(1+y'^2)^{3/2}} \]
其中令 $R = 1/k$ 为曲线的曲率半径。

\section{中值定理}

微分中值定理主要有三个：Rolle 定理、Lagrange 中值定理和 Cauchy 中值定理。

\subsection{Rolle 定理}

\begin{theorem}[罗尔 Rolle 中值定理]
	若函数 $f$ 在 $[a,b]$ 上连续可导，且 $f(a)=f(b)$。则存在 $\xi\in(a,b)$，使得 $f'(\xi)=0$。
\end{theorem}

\begin{proof}
	因为 $f(x)$ 在 $[a,b]$ 上连续，所以有最大值 $M$ 和最小值 $m$。

	1. 若 $m=M$，显然成立。

	2. 若 $m < M$，又 $f(a) = f(b)$，故最值必然在 $\xi \in (a, b)$ 中取到，从而 $x=\xi$ 是其极值点，由 Fermat 定理知 $f'(\xi) = 0$。
\end{proof}

我们可以做更多点的推广。假如 $f(x_1) = f(x_2) = f(x_3)$ 都相等，据此存在 $\xi_1 \in (x_1, x_2)$ 和 $\xi_2 \in (x_2, x_3)$ 使得 $f'(\xi_1) = f'(\xi_2) = 0$，再用一遍定理知存在 $\xi_3 \in (\xi_1, \xi_2)$ 使得 $f''(\xi_3) = 0$。

\begin{example}
	设 $f$ 在 $[a,b]$ 上连续并二阶可导，且 $f(a) = f(b) = 0$，那么对任意的 $x \in (a, b)$ 存在 $\xi_x \in (a,b)$ 满足
	\[ f(x) = \frac{f''(\xi_x)}{2}(x-a)(x-b) \]
\end{example}

\begin{proof}
	对于任意的 $x$，我们定义常数
	\[ \lambda_x = \frac{2 f(x)}{(x - a)(x - b)} \]
	构造函数
	\[ F(u) = f(u) - \frac{\lambda_x}{2} (u-a)(u-b) \]
	注意到 $F(a) = F(x) = F(b)$，且 $F''(u) = f''(u) - \lambda_x$，由上文所证性质，故存在 $\xi_x \in (a, b)$ 使得 $f''(\xi_x) = \lambda_x$。
\end{proof}

\begin{example}
	设函数 $f$ 在 $[a,b]$ 上连续并三阶可导，如果 $f(a) = f'(a) = f(b) = 0$，那么对任意的 $x$ 存在 $\xi_x \in (a, b)$ 使得
	\[ f(x) = \frac{f'''(\xi_x)}{3!} (x-a)^2(x-b) \]
\end{example}

\begin{proof}
	构造
	\[ F(u) = f(u) - \frac{\lambda_x}{3!}(u-a)^2(u-b), \quad \lambda_x = \frac{3! f(x)}{(x-a)^2(x-b)} \]
	余略。
\end{proof}


\subsection{Lagrange 定理}

Rolle 定理需要两个函数等高，假如不等高我们可以旋转一下。

\begin{theorem}[Lagrange 定理]
	若函数 $f$ 在 $[a,b]$ 上连续，在 $(a,b)$ 中可微，则存在 $\xi\in(a,b)$，使得
	\[ f'(\xi)=\frac{f(b)-f(a)}{b-a} \]
\end{theorem}

\begin{proof}
	做辅助函数
	\[ F(x) = f(x) - f(a) - \frac{f(b) - f(a)}{b - a}(x - a) \]
	显然 $F(a) = F(b) = 0$，且满足 Rolle 定理的其他两个条件，故存在 $\xi \in (a, b)$ 使得
	\[ F'(\xi) = f'(\xi) - \frac{f(b) - f(a)}{b - a} = 0 \]
	移项即证。
\end{proof}

一般可以直接说，存在 $\xi \in (a, b)$ 使得 $f(b) - f(a) = f'(\xi)(b-a)$。考虑设
\[ \xi = (1-\theta)a + \theta b = a + \theta(b-a), \quad \theta \in (0, 1) \]
因此可以说存在 $\theta \in (0, 1)$ 使得
\[ f(b) - f(a) = f'(a + \theta(b-a)) (b-a) \]

\subsection{Cauchy 中值定理}

\begin{theorem}
	设 $f,g$ 在 $[a,b]$ 上连续，在 $(a,b)$ 中可微，且 $g'(x)\ne 0$，则存在 $\xi\in (a,b)$，使得
	\[ \frac{f(b)-f(a)}{g(b)-g(a)} = \frac{f'(\xi)}{g'(\xi)} \]
\end{theorem}

\begin{proof}
	首先注意到 $g(b) \neq g(a)$，否则由 Rolle 定理知存在 $g'(x) = 0$。构造
	\[ F(x) = f(x) - f(a) - \lambda (g(x) - g(a)) , \quad \lambda = \frac{f(b) - f(a)}{g(b) - g(a)} \]
	注意到 $F(a) = F(b) = 0$，由 Rolle 定理知存在 $\xi \in (a, b)$
	\[ F'(\xi) = f'(\xi) - \lambda g'(\xi) = 0 \]
\end{proof}

Cauchy 中值定理就更加的变化多端了。

\begin{proposition}
	设 $f$ 是 $[a,b]$ 上的连续可导函数，且 $0 < a < b$，那么存在 $\xi, \eta \in (a,b)$ 使得
	\[ f'(\xi) = \frac{a+b}{2\eta}f'(\eta) \]
\end{proposition}

\begin{proof}
	首先存在 $\xi \in (a,b)$ 使得
	\[ f'(\xi) = \frac{f(b) - f(a)}{b - a} \]
	构造
	\[ F(x) = f(x) - f(a) - \frac{f(b) - f(a)}{b^2 - a^2}(x^2 - a^2) \]
	注意到 $F(a) = F(b) = 0$，因此存在 $\eta \in (a, b)$ 使得
	\[ F'(\eta) = f'(\eta) - 2 \eta \frac{f(b) - f(a)}{b^2 - a^2} = f'(\eta) - \frac{2 \eta f'(\xi)}{b + a} = 0 \] 
\end{proof}

\begin{proposition}
	设 $f$ 是 $[a,b]$ 上的连续可导函数，且 $f'(a) = f'(b)$，那么存在 $\xi \in (a,b)$ 使得
	\[ f(\xi) - f(a) = f'(\xi)(\xi - a) \]
\end{proposition}

\begin{proposition}
	设函数 $f$ 是 $[a,b]$ 上连续且二阶可导，且 $f'(a) = f'(b) = 0$，那么存在 $c \in (a,b)$ 使得
	\[ |f''(c)| \geqslant \frac{4}{(b-a)^2} |f(b) - f(a)| \]
\end{proposition}

\begin{proof}
	我们选取 $x_0$ 构造
	\[ F(x) = f(x) - f(x_0) - f'(x_0)(x-x_0) , \quad G(x) = (x-x_0)^2 \]
	连续使用两次微分中值定理得到
	\[ \frac{F(x)}{G(x)} = \frac{F(x) - F(x_0)}{G(x) - G(x_0)} = \frac{F'(\xi_1)}{G'(\xi_1)} = \frac{f'(\xi_1) - f'(x_0)}{2 (\xi_1 - x_0)} = \frac{f''(\xi_2)}{2} \]
	其中 $x_0 < \xi_2 < \xi_1 < x$。定 $x=\frac{a+b}{2}$，取 $x_0 = a$ 得到
	\[ f\left(\frac{a+b}{2}\right) = f(a) + \frac{f''(\eta_1)}{8} (b-a)^2, \quad \eta_1 \in \left(a, \frac{a+b}{2}\right) \]
	同理可取 $x_0 = b$ 得到
	\[ f\left(\frac{a+b}{2}\right) = f(b) + \frac{f''(\eta_2)}{8} (b-a)^2, \quad \eta_2 \in \left(\frac{a+b}{2}, b\right) \]
	从而有
	\[ \frac{4(f(b) - f(a))}{(b-a)^2} = \frac{f''(\eta_1) - f''(\eta_2)}{2} \]
	故
	\[ \frac{4}{(b-a)^2}|f(b) - f(a)| = \frac{|f''(\eta_1) - f''(\eta_2)|}{2} \leqslant \max\{f''(\eta_1), f''(\eta_2)\} \]
\end{proof}

\subsection{凹凸性}

\begin{definition}
	设 $f$ 为定义在区间 $I$ 上的函数，若对 $I$ 上当任意两点 $x_1,x_2$ 和任意实数 $\lambda\in (0,1)$ 总有
	\[ f(\lambda x_1+(1-\lambda)x_2) \leqslant \lambda f(x_1)+(1-\lambda)f(x_2) \]
	则称 $f$ 为 $I$ 上的凸函数。反之，如果总有
	\[ f(\lambda x_1+(1-\lambda)x_2) \geqslant \lambda f(x_1)+(1-\lambda)f(x_2) \]
	则称 $f$ 为 $I$ 上的凹函数。
\end{definition}

\section{L'Hospital 法则}



\begin{theorem}
	设 $f,g$ 是 $(a,b)$ 上的连续可导函数，$g' \neq 0$，且
	\[ \lim_{x \to a^{+}} f(x) = \lim_{x \to a^{+}} g(x) = 0 \]	
	如果极限
	\[ \lim_{x \to a^{+}} \frac{f'(x)}{g'(x)} = A \]
	其中 $A$ 为实数或 $\infty$。则
	\[ \lim_{x \to a^{+}} \frac{f(x)}{g(x)} = \lim_{x \to a^{+}} \frac{f'(x)}{g'(x)} \]
\end{theorem}

