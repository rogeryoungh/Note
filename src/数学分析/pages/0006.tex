\chapter{级数理论}

\section{数项级数的敛散性}

给定一个无穷数列 $\{a_n\}$，称形式和
\[ \sum_{i=1}^\infty a_i = a_1 + a_2 + a_3 + \cdots \]
为无穷级数，其中 $a_i$ 记作通项或一般项。对于前 $n$ 项和，我们称为第 $n$ 个部分和。

若 $\lim_{n \to \infty} S_n = S$ 存在且有限，则称级数级数 $\sum a_i$ 收敛，否则就称级数发散。

显然若级数 $\sum a_i$ 收敛，则通项
\[ a_n = S_n - S_{n-1} \to S - S = 0 \quad(n \to \infty) \]

\begin{theorem}[Cauchy 准则]
	给定级数 $\sum a_i$，存在 $N = N(\eps)$ 使得当 $n > N$ 时有
	\[ |S_{n+p} - S_{n}| = |a_{n+p} + \cdots + a_{n+1}| < \eps \]
\end{theorem}

显然级数的有限项不影响级数的敛散性，以下讨论均舍弃。

\section{正项级数的敛散性}

若级数各项的符号都相同，则称为同号级数；进一步的，若皆为正号，则称为正项级数。由于 $0$ 并不影响收敛性，故以下讨论的正项级数可含 $0$。

\begin{theorem}[基本判别法]
	正项级数 $\sum a_i$ 收敛的充要条件是：部分和数列 $\{S_n\}$ 有界。
\end{theorem}

\begin{theorem}[比较原则]
	设正项级数 $\sum a_i, \sum b_i$，若存在正数 $N$，使得
	\[ a_i \leqslant b_i, \quad \forall n \geqslant N \]
	那么

	（1） 若级数 $\sum b_i$ 收敛，则级数 $\sum a_i$ 收敛。

	（2） 若级数 $\sum a_i$ 发散，则级数 $\sum b_i$ 发散。
\end{theorem}

\begin{proof}
	设其部分和分别为 $A_i, B_i$。不妨假设 $N=1$，即对数列的每项都成立。

	（1） 显然有
	\[ A_i \leqslant B_i \leqslant B \]
	即 $A_i$ 为单调有界数列，故必有极限 $A$，因此级数 $\sum a_i$ 收敛。

	（2） 其为（1）的逆否命题，也成立。
\end{proof}

因此我们可以通过比较、放缩等手段，将待判级数和已知敛散性的级数进行比较。

一个重要的已知级数是等比级数，我们有三种判断手段。

\begin{theorem}[比式判别法]
	设 $\sum a_i$ 是正项级数，却存在某正数 $N$ 和 $q(0 < q < 1)$ 使得
	\[ a_{n+1} / a_n \leqslant q, \quad \forall n \geqslant N \]
	则级数 $\sum a_i$ 收敛；若
	\[ a_{n+1} / a_n \geqslant 1, \quad \forall n \geqslant N \]
	则级数 $\sum a_i$ 发散。


	（极限形式）且
	\[ \lim_{n \to \infty} \frac{a_{n+1}}{a_n} = q \]
	则当 $q < 1$ 时，级数收敛；$q > 1$ 时，级数发散。
\end{theorem}

\begin{proof}
	（1） 不妨设 $N = 1$，则有 $a_n \leqslant q^{n-1}a_1$。而等比级数显然是收敛的，故收敛。

	（2） 显然当 $n > N_0$ 时 $a_n \geqslant n_0 > 0$，其每项的极限不趋于 $0$，故发散。

	（极限形式）由极限知，我们取 $\eps = \frac{|1-q|}{2}$，存在正数 $N$ 使得当 $n > N$ 时有
	\[ q - \eps < \frac{a_{n+1}}{a_n} < q + \eps \]

	当 $q<1$ 时，显然 $q + \eps = \frac{1+q}{2} < 1$，由比式判别法知收敛。

	当 $q > 1$ 时，$q - \eps = \frac{1+q}{2} > 1$，由比式判别法知发散。
\end{proof}

\begin{theorem}[Cauchy 判别法（根式判别法）]
	设 $\sum a_i$ 是正项级数，且存在正数 $N$ 和正常数 $q$ 使得
	\[ \sqrt[n]{a_n} \leqslant q < 1, \forall n > N \]
	则级数收敛；若
	\[ \sqrt[n]{a_n} \geqslant 1, \forall n > N \]
	则级数发散。
\end{theorem}

\begin{proof}
	（1） 不妨设 $N=1$，显然 $a_n \leqslant q^n$，由等比级数收敛知原级数也收敛。

	（2） 显然 $a_n \geqslant 1^n = 1$，故发散。
\end{proof}

\begin{theorem}[积分判别法]
	设 $f$ 是 $[1, \infty)$ 上的减函数，则级数 $\sum f(i)$ 收敛的充分必要条件是反常积分 $\int_{1}^{+\infty} f(x) \d x$ 收敛。
\end{theorem}

\begin{proof}
	假设级数收敛于 $S$，由收敛的性质知，$\lim_{n \to \infty} f(n) = 0$，故 $f$ 非负。进而对任意正整数 $N$ 有
	\[ \int_{1}^{N} f(x) \d x = \sum_{n=2}^N \int_{n -1}^{n} f(x) \d x \leqslant \sum_{n=1}^{N-1} f(n) \leqslant \sum_{n=1}^{\infty} f(n) = S \]
	考虑对 $M \in (N, N + 1]$，都有
	\[ 0 \leqslant \int_{1}^{M} f(x) \d x \leqslant \int_{1}^{N+1} \leqslant S \]
	因此该反常积分收敛。

	反之，设反常积分。。。不想证了 TODO
\end{proof}

\begin{theorem}[Kummer]
	设 $\sum a_i, \sum b_i$ 为正项级数，若 $n$ 充分大时有
	\[ \frac{1}{b_n} \cdot \frac{a_n}{a_{n+1}} - \frac{1}{b_{n+1}} \geqslant \lambda > 0 \]
	则 $\sum a_n$ 收敛；若
	\[ \frac{1}{b_n} \cdot \frac{a_n}{a_{n+1}} - \frac{1}{b_{n+1}} \leqslant 0 \]
	且 $\sum b_n$ 发散，则 $\sum a_n$ 发散。
\end{theorem}

\begin{proof}
	（1） 条件即
	\[ a_{n+1} \leqslant \frac{1}{\lambda} \left( \frac{a_n}{b_n} - \frac{a_{n+1}}{b_{n+1}} \right) \]
	设 $S_n$ 是 $a_n$ 的和函数，有
	\[ S_{n+1} \leqslant S_N +\frac{1}{\lambda} \left( \frac{a_N}{b_N} - \frac{a_{n+1}}{b_{n+1}} \right) \leqslant S_N + \frac{1}{\lambda} \frac{a_N}{b_N} \]
	从而 $S_N$ 有上界，故收敛。

	（2） 可知
	\[ \frac{1}{b_n} \cdot \frac{a_n}{a_{n+1}} - \frac{1}{b_{n+1}} \leqslant 0 \Longrightarrow \frac{a_1}{b_1} \leqslant \cdots \leqslant \frac{a_n}{b_n} \leqslant \frac{a_{n+1}}{b_{n+1}} \]
	故 $a_n \geqslant \frac{a_1}{b_1} b_n$，由 $\sum b_n$ 知 $\sum a_n$ 也发散。
\end{proof}

当 $b_n = 1$ 时即得比值判别法；取 $b_n = \frac{1}{n}$ 就是 Raabe 判别法；取 $b_n = \frac{1}{n \ln n}$，则得 Gauss 判别法。

\begin{theorem}[Cauchy 凝聚判别法]
	设 $a_n$ 单调递减趋于 $0$。则 $\sum a_n$ 收敛当且仅当 $\sum 2^k a_{2^k}$ 收敛。
\end{theorem}

在 Taylor 公式中，我们经常得到正负项交替出现的级数，我们称为交错级数。

\begin{theorem}[Leibniz 判别法]
	若 $a_n$ 单调递减趋于 $0$，则级数 $\sum (-1)^{n-1} a_n$ 收敛。
\end{theorem}

\begin{proof}
	懒得证了，TODO。大致思想是注意到 $S_{2m-1}$ 和 $S_{2m}$ 分别是单减和单增的，从而 $[S_{2m-1}, S_{2m}]$ 是退缩区间套。
\end{proof}

\section{一般项级数收敛判别法}

若级数 $\sum a_n$ 各项绝对值组成的级数 $\sum |a_n|$ 收敛，那么称原级数绝对收敛；若原级数收敛，绝对值级数不收敛，则称为条件收敛。

更神秘的判别法，比如 Abel 判别法、Dirichlet 判别法感觉不太用得到，跳过。


\section{函数项级数的一致收敛}

设 $f_1, f_2, \cdots$ 是 $E$ 上的函数列，记为 $\{f_i\}$。若带入 $x = x_0$ 使得函数列的值收敛，则称函数列在点 $x_0$ 收敛，$x_0$ 称为函数列的收敛点；反之若发散，则称发散点。

若函数列在 $D \subset E$ 上每一点都收敛，则称其在数集 $D$ 上收敛。此时对函数上每一点 $x$，都有一个极限值与之对应，称为函数列的极限函数。记为
\[ \lim_{n \to \infty} f_n(x) = f(x) \]
函数列的全体收敛点集，称为收敛域。

用 $\eps - N$ 语言表示即：对任意固定的 $x \in D$，任给 $\eps$ 恒存在 $N(\eps, x)$ 使得当 $n > N$ 时有
\[ | f_n(x) - f(x) | < \eps \]
则称 $\lim_{n \to \infty} f_n(x) = f(x)$。

对于函数列，我们不仅要讨论其收敛域，还需要更多的性质，比如连续性、导数、积分是否在极限下不变。

\begin{definition}
	若对于函数列 $\{f_n\}$ 对任给的正数 $\eps$ 总存在某一正整数 $N(\eps)$ 使得当 $n > N$ 时对一切 $x \in D$ 都有
	\[ |f_n(x) - f(x)| < \eps \]
	则称函数列一致收敛于 $f$，记作
	\[ f_n(x) \rightrightarrows f(x) (n \to \infty) \]
\end{definition}

一致收敛是比收敛更强的性质。反之，存在 $\eps$ 使得对任何 $N$ 都有 $x(N)$ 和 $n(N) > N$ 使得
\[ |f_n(x) - f(x) | \geqslant \eps \]
则称其不一致收敛。

\begin{theorem}[函数列一致收敛 Cauthy 准则]
	给定函数列 $\{f_n\}$ 在 $D$ 上一致收敛的充要条件是：对任给 $\eps > 0$ 都存在正数 $N$ 使得 $n, m > N$ 时，对一切 $x \in D$ 都有
	\[ |f_n(x) - f_m(x) | < \eps \]
\end{theorem}

\begin{proof}
	先证必要性，已知 $f_n(x) \rightrightarrows f(x)$，显然我们可以取 $\frac{\eps}{2}$ 使得
	\[ |f_n(x) - f_m(x)| \leqslant |f_n(x) - f(x)| + |f_m(x) - f(x)| < \frac{\eps}{2} + \frac{\eps}{2} = \eps \]

	再证必要性，考察每个点由 Cauthy 定理知其收敛，故一致收敛。
\end{proof}


\begin{definition}
	若函数列 $\{f_n\}$ 定义在区间 $I$ 上，若对任意闭区间 $[a, b] \subset I$，函数列在 $[a, b]$ 上一致收敛于 $f$，则称 $\{f_n\}$ 在函数列上一致收敛。
\end{definition}


对于函数列，我们也可以定义函数项级数，和其部分和数列。

\section{幂级数初步}

接下来主要讨论幂函数序列 $\{a_n(x- x_0)^n \}$ 所产生的函数项级数
\[ \sum_{n=0}^{\infty} = a_0 + a_1(x-x_0) + a_2(x-x_0)^2 + \cdots \]
记作幂级数，接下来主要讨论 $x_0 = 0$。

\begin{theorem}
	若幂级数 $\sum f_i x^i$ 在 $x = x_1 \neq 0$ 处收敛，则对任何 $|x| < |x_1|$ 幂级数都绝对收敛；若幂级数在 $x = x_1$ 处发散，则对任何 $|x| > |x_1|$ 幂级数都发散。
\end{theorem}

\begin{proof}
	设 $\sum f_i x_1^i$ 收敛，则 $\{f_i x_1^i\}$ 收敛于 $0$ 且有界，那么对任意 $|x| < |x_1|$ 其仍收敛于 $0$ 且有界，且每一项都严格小于 $\{f_i x_1^i\}$，因此绝对收敛。

	那么若 $x_1$ 处发散，假如存在 $|x_2| > |x_1|$ 使得收敛，则由前证矛盾，故收敛。
\end{proof}

因此幂级数的收敛域是关于原点对称的区间，我们记区间长度为 $2R$，那么收敛半径为 $R$。对于 $x = \pm R$ 处，级数可能收敛，也可能不收敛。

\begin{theorem}
	对于幂级数 $\sum f_i x^i$ 若
	\[ \lim_{n \to \infty} \sqrt[n]{|a_n|} = \rho \]
	\begin{itemize}
		\item 若 $\rho = 0$ 时，幂级数的收敛半径是 $R = +\infty$。
		\item 若 $\rho > 0$ 时，幂级数的收敛半径是 $R = \frac{1}{\rho}$。
		\item 若 $\rho = \infty$ 时，幂级数的收敛半径是 $R = 0$。
	\end{itemize}
\end{theorem}

\section{Fourier 级数}

函数列
\[ 1, \quad \cos x, \quad \sin x, \quad \cos 2x, \quad \sin 2x , \cdots \]
称为三角函数系，若这一列的函数记为 $\{\varphi_i(x)\}$ 则
\[ \int_{-\pi}^{\pi} \varphi_i(x) \varphi_j(x) \d x = 0, \quad \forall i \neq j \]
这个性质称为三角函数系的正交性。有限和
\[ a_0 + \sum_{k=1}^n (a_k \cos kx + b_k \sin kx) \]
称为三角多项式，而形式和
\[ a_0 + \sum_{k=1}^\infty (a_k \cos kx + b_k \sin kx) \]
称为三角级数，其中 $a_0, a_k, b_k$ 称为三角函数的系数。

\begin{definition}
	假设 $f$ 是一个周期为 $2\pi$ 的 Riemann 可积函数，令
	\[ a_k = \frac{1}{\pi} \int_{-\pi}^{\pi} f(x) \cos kx \d x, \quad b_k = \frac{1}{\pi} \int_{-\pi}^{\pi} f(x) \sin k x \d x \]
	其中 $a_0, a_k, b_k$ 称为 $f$ 的 Fourier 级数，形式和
	\[ \frac{a_0}{2} + \sum_{k=1}^\infty (a_k \cos k x+ b_k \sin k x) \]
	称为 $f$ 的 Fourier 级数或者 Fourier 展开。
\end{definition}
